<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>uglify</title>
</head>
<body>
  <div></div>
</body>
<script>
(function() {
  /**
   * 格式化函数
   *
   * @param {string} template 模板
   * @param {object} json 数据项
   */
  function format(template, json) {
    if (typeof template === 'function') { // 函数多行注释处理
      template = String(template).replace(
        /[^]*\/\*!?\s*|\s*\*\/[^]*/g, // 替换掉函数前后部分
        ''
      );
    }
    return template.replace(/#\{(.*?)\}/g, function(all, key) {
        return json && (key in json) ? json[key] : "";
    });
  }
  var now = new Date();
  document.querySelector('div').innerHTML = format(
    "<h1>#{title}</h1>\n      <label><em>#{date}</em></label>"
    , {
      title: 'uglify',
      date: [
        now.getFullYear(),
        now.getMonth() + 101,
        now.getDate() + 100
      ].join('-').replace(/-1/g, '-')
    }
  );
})();
</script>
</html>